#include "PearsonHash.h"

std::vector<unsigned char> PearsonHash(std::vector<unsigned char> inputBytes, int numOfBytesOut)
{
    unsigned char T[256] = {
    134, 16, 182, 220, 189, 168, 97, 228, 119, 23, 98, 231, 163, 207, 103, 93,
    26, 108, 140, 203, 57, 105, 135, 42, 1, 113, 21, 13, 225, 87, 155, 248,
    200, 32, 61, 111, 128, 250, 243, 177, 38, 205, 48, 132, 185, 219, 79, 154,
    22, 19, 198, 162, 50, 62, 17, 252, 99, 178, 222, 6, 239, 236, 159, 34,
    210, 199, 224, 146, 196, 88, 65, 187, 195, 69, 171, 85, 180, 254, 176, 212,
    14, 152, 80, 197, 39, 74, 43, 86, 158, 70, 41, 20, 199, 45, 40, 210,
    109, 190, 167, 161, 153, 186, 125, 104, 204, 179, 137, 73, 107, 78, 83, 5,
    172, 116, 129, 217, 68, 191, 123, 211, 47, 84, 18, 31, 75, 92, 94, 214,
    110, 35, 142, 44, 194, 126, 66, 27, 36, 226, 12, 247, 143, 28, 138, 4,
    8, 96, 156, 206, 133, 58, 151, 174, 144, 120, 90, 91, 64, 235, 60, 147,
    33, 233, 216, 63, 121, 173, 218, 15, 141, 145, 244, 115, 100, 241, 0, 213,
    7, 76, 150, 193, 234, 229, 192, 112, 46, 240, 3, 238, 81, 124, 102, 183,
    137, 184, 215, 208, 117, 9, 188, 237, 114, 227, 24, 139, 55, 165, 252, 72,
    149, 56, 122, 10, 164, 101, 136, 209, 118, 53, 67, 249, 170, 2, 202, 201,
    111, 71, 95, 246, 30, 59, 232, 175, 29, 77, 51, 223, 16, 106, 206, 11,
    166, 157, 160, 255, 130, 37, 221, 173, 186, 89, 253, 127, 91, 148, 100, 169
    };

    std::vector<unsigned char> output;

    for (int i = 1; i <= numOfBytesOut; ++i) 
    {
        unsigned char h_i = T[(inputBytes[0] + i) % 256];
        for (int j = 1; j < inputBytes.size(); ++j)
        {
            h_i = T[inputBytes[j] xor h_i];
        }
        output.push_back(h_i);
    }

    return output;
}